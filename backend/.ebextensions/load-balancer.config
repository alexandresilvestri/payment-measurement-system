option_settings:
  # Change environment type to load balanced
  aws:elasticbeanstalk:environment:
    EnvironmentType: LoadBalanced
    LoadBalancerType: application

  # Configure the load balancer
  aws:elasticbeanstalk:environment:process:default:
    HealthCheckPath: /api/user-types
    Port: '8080'
    Protocol: HTTP
    MatcherHTTPCode: '200'
    HealthCheckInterval: '15'
    HealthCheckTimeout: '5'
    HealthyThresholdCount: '3'
    UnhealthyThresholdCount: '5'

  # Configure HTTPS listener (port 443)
  aws:elbv2:listener:443:
    Protocol: HTTPS
    SSLPolicy: ELBSecurityPolicy-2016-08
    DefaultProcess: default

  # Configure HTTP listener (port 80) - redirect to HTTPS
  aws:elbv2:listener:80:
    Protocol: HTTP
    DefaultProcess: default
